<script type="text/javascript">
$(document).ready(function(){
    $('#mainTable').DataTable({
        "dom": '<"row" <"col-md-4"<"pull-left"f>><"col-md-3"<"pull-right"i>>><"row"<"col-md-12" tlp>>',
        "ajax": {
            "url": "@routes.Application.listBooks",
            "dataSrc": "",
        },
        "columns": [
            {"data": "id", "width": "10%"},
            {"data": "title"},
            {"data": "author"},
            {"data": "pages", "width": "10%",},
            {
                "sortable": false,
                "width": "10%",
                "render": function (data, type, row) {
                    return '<a class="editBookBtn btn btn-lg ui-tooltip fa fa-pencil" style="font-size: 22px;" onclick="editItem(\'' + row.id + '\')" data-original-title="Edit"></a>  <a class="btn btn-lg ui-tooltip fa fa-trash-o" onclick="removeItem(\'' + row.id + '\')" style="font-size: 22px;" data-original-title="Delete"></a>';
                }
            }
        ]
    });
});
$(function() {
    $("#addBookBtn").click(function(a){
        $("#modalFields").empty();
        $("#bookModal").modal("show")
        $.get("@routes.Application.upsertBook(true, 0L)", function(data){
           $("#modalFields").append(data);
           $("#modalTitle").html("Create book");
        });
    });
});

function editItem(id){
   $("#modalFields").empty();
   $("#bookModal").modal("show")
   $.get("/book/false," + id , function(data){
       $("#modalFields").append(data);
       $("#modalTitle").html("Edit book");
   });
};
function removeItem(id){
    bootbox.confirm({
        size: "small",
        message: "Are you sure?",
        callback: function(res) {
            if(res){
                $.ajax({
                    url: '/book/' + id,
                    type: 'DELETE',
                    success: function(result) {
                       if (result.redirect) {
                            window.location.href = result.redirect;
                       }
                    }
                });
            }
        }
    });
};
</script>



<!-- Modal -->
<div class="modal fade" id="bookModal" tabindex="-1" role="dialog" aria-labelledby="bookModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" id="modalContent">

            <div class="modal-header">
                <div class="row">
                    <div class="col-md-12">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                        <h4 class="modal-title" id="modalTitle"></h4>
                    </div>
                </div>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-4">
                        <form action="UploadImages" class="dropzone" id="fileupload" enctype="multipart/form-data">

                        </form>
                    </div>

                    <div id="modalFields">

                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="submit" form="bookForm" class="btn btn-primary">Submit</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<div class="row">
    <div class="col-md-2 col-md-offset-10">
        <a id="addBookBtn" class="btn btn-primary btn-lg pull-right">Add new</a>
    </div>

    <table id="mainTable" class="display">
        <thead>
            <tr>
                <th>Id</th>
                <th>Title</th>
                <th>Author</th>
                <th>Pages</th>
                <th>Actions</th>
            </tr>
        </thead>

    </table>
</div>